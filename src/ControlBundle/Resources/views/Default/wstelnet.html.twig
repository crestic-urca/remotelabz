
{% block body %}
Host: <input id='host' style='width:100'>&nbsp;
        Port: <input id='port' style='width:50'>&nbsp;
        Encrypt: <input id='encrypt' type='checkbox'>&nbsp;
        <input id='connectButton' type='button' value='Connect' style='width:100px'
            onclick="connect();">&nbsp;

        <br><br>

        <pre id="terminal"></pre>	
{% endblock %}

{% block javascripts %}
<script src="{{asset('js/wstelnet/base64.js')}}"></script>
<script src="{{asset('js/wstelnet/util.js')}}"></script>
<script src="{{asset('js/wstelnet/websock.js')}}"></script>
<script src="{{asset('js/wstelnet/webutil.js')}}"></script>
<script src="{{asset('js/wstelnet/keysym.js')}}"></script>
<script src="{{asset('js/wstelnet/VT100.js')}}"></script>
<script src="{{asset('js/wstelnet/wstelnet.js')}}"></script>

<script>
		var telnet;

            function connect() {
                telnet.connect($D('host').value,
                               $D('port').value,
                               $D('encrypt').checked);
                $D('connectButton').disabled = true;
                $D('connectButton').value = "Connecting";
            }

            function disconnect() {
                $D('connectButton').disabled = true;
                $D('connectButton').value = "Disconnecting";
                telnet.disconnect();
            }

            function connected() {
                $D('connectButton').disabled = false;
                $D('connectButton').value = "Disconnect";
                $D('connectButton').onclick = disconnect;
            }

            function disconnected() {
                $D('connectButton').disabled = false;
                $D('connectButton').value = "Connect";
                $D('connectButton').onclick = connect;
            }

            window.onload = function() {
                console.log("onload");
                var url = document.location.href;
                $D('host').value = (url.match(/host=([^&#]*)/) || ['',''])[1];
                $D('port').value = (url.match(/port=([^&#]*)/) || ['',''])[1];

                telnet = Telnet('terminal', connected, disconnected);
            }
</script>
		
{% endblock %}